up: build
	docker-compose -f etc/docker/docker-compose.yml up -d

build:
	docker-compose -f etc/docker/docker-compose.yml build

db-create:
	@echo "Creating database.."
	docker exec -i psql psql -U laura -d pentestify -f - < ./src/utils/postgres/create.sql
	@echo "Database created."

db-clean:
	@echo "Cleaning database.."
	docker exec -i psql psql -U laura -d pentestify -f - < ./src/utils/postgres/cleanup.sql
	@echo "Database cleaned."

tests: build
	@echo "Running tests.."
	docker run -t --rm pentestify-main  pytest
	@echo "Tests completed."

lint:
	@echo "Running flake8.."
	docker run -t --rm pentestify-main flake8 .
	@echo "Flake8 completed."

fix:
	@echo "Running autopep8.."
	docker run -t --rm pentestify-main autopep8 --in-place --recursive . --exclude=libs
	@echo "Autopep8 completed."