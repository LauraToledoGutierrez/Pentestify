from NetworkManagement.Domain.AnalyseWPRepositoryInterface import AnalyseWPRepositoryInterface
from Shared.Infrastructure.Postgres.OperationsBD import OperationsBD
from Shared.Infrastructure.Postgres.PostgresConnection import PostgresConnection


class AnalyseWPRepository(AnalyseWPRepositoryInterface):
    def save(self, clean_data, db_connection: PostgresConnection):
        db_connection.connect()
        operations = OperationsBD(db_connection)

        operations.save_wordpress_info(clean_data.to_s)

        print("WPScan output saved in database successfully.")
