from NetworkManagement.Domain.DNSManagerInterface import DNSManagerInterface
import dns.resolver


class DnsManagerRepository(DNSManagerInterface):

    def verify_type(self, domain, type):
        try:
            answers = dns.resolver.query(domain, type)
            answers_response = []
            for rdata in answers:
                answers_response.append(rdata.address)
            return answers_response
        except dns.resolver.NoAnswer:
            return False
        except dns.resolver.NXDOMAIN:
            return False

    def verify(self, domain):
        resp = self.verify_type(domain, 'A')
        if not resp:
            resp = self.verify_type(domain, 'AAAA')
            if not resp:
                resp = self.verify_type(domain, 'CNAME')
                if not resp:
                    return False
        return resp
