import string
from Report.Domain.RenderInterface import RenderInterface
from Shared.Domain import SubdomainRepositoryInterface
from Shared.Domain import WorpressInterface
from Shared.Domain import PortRepositoryInterface


class GenerateReport:
    subdomain_repository: SubdomainRepositoryInterface
    render: RenderInterface

    def __init__(self, subdomain_repository: SubdomainRepositoryInterface,
                 port_repository: PortRepositoryInterface,
                 wordpress_repository: WorpressInterface,
                 render: RenderInterface):
        self.subdomain_repository = subdomain_repository
        self.port_repository = port_repository
        self.wordpress_repository = wordpress_repository
        self.render = render

    def execute(self, template_name: str, dominio: str) -> string:
        subdomains = self.subdomain_repository.get_subdomains(dominio)
        ports = self.port_repository.get_ports(dominio)
        entry = self.wordpress_repository.get_info()

        data = {
            "subdomains": subdomains,
            "ports": ports,
            "entry": entry
        }
        webpage = self.render.render(template_name, data)
        return webpage
