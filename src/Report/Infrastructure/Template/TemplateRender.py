from Report.Domain.RenderInterface import RenderInterface
from jinja2 import Environment, FileSystemLoader, select_autoescape
import os


class TemplateRender(RenderInterface):
    def render(self, template_name, data):
        try:
            env = Environment(loader=FileSystemLoader(os.path.abspath(os.getcwd(
            )) + "/src/Report/Infrastructure/Template/Templates"), autoescape=select_autoescape(['html', 'xml']))
            template = env.get_template(template_name)

        except Exception as e:
            raise Exception("Error loading template"+str(e))

        html_content = template.render(data)

        return html_content
