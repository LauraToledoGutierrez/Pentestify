from typing import Dict, List

from Shared.Domain.Event import Event
from Shared.Domain.EventType import EventType


class SubdomainDiscoveredEvent(Event):
    def __init__(self, subdomain, ips: List[str]):
        super().__init__(EventType.DOMAIN_DISCOVERED, payload={'subdomain': subdomain, 'ips': ips})
        self.subdomain = subdomain
        self.ips = ips

    def __str__(self):
        return "DomainDiscoveredEvent: %s" % self.subdomain

    @staticmethod
    def fromJson(data: Dict[str, any]):

        return SubdomainDiscoveredEvent(data['subdomain'], data['ips'])
