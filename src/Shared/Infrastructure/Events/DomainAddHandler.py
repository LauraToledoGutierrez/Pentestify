from NetworkManagement.Application.DiscoverSubdomains import DiscoverSubdomains
from Shared.Domain.EventBusInterface import EventBusInterface
from Shared.Domain.EventHandler import EventHandler
from Shared.Domain.Events.DomainAddEvent import DomainAddEvent


class DomainAddHandler(EventHandler):

    def __init__(self, event_bus: EventBusInterface, discover_subdomains: DiscoverSubdomains):
        self.event_bus = event_bus
        self.discover_subdomains = discover_subdomains

    def handle(self, event: DomainAddEvent):
        print(f"ExtractDomainHandler: {event.domain}")

        events = self.discover_subdomains.execute(event.domain)
        for event in events:
            self.event_bus.send_event(event)
