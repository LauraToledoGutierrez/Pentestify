from Shared.Infrastructure.Postgres.OperationsBD import OperationsBD
from Shared.Domain.InitialSubdomain import InitialSubdomain
from Shared.Infrastructure.Postgres.PostgresConnection import PostgresConnection


class OperationsFile:
    def process_and_store_data(self, json_data):
        postgress_connection = PostgresConnection()
        postgress_connection.connect()
        for subdomain in json_data['hosts']:
            if not (':' in subdomain or subdomain.startswith('*.')):
                operation = OperationsBD(postgress_connection)
                operation.save_initial_subdomain(InitialSubdomain(subdomain))
