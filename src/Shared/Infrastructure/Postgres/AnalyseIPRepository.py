from typing import List
from Shared.Infrastructure.Postgres.PostgresConnection import PostgresConnection
from Shared.Domain.SubdomainIP import SubdomainIP


class AnalyseIPRepository:
    database_connector: PostgresConnection

    def __init__(self, database_connector: PostgresConnection):
        self.database_connector = database_connector

    def get_ip(self) -> List[SubdomainIP]:
        ip_data = self.database_connector.query_all(
            "SELECT DISTINCT ip_address FROM subdomains WHERE ip_address IS NOT NULL")
        if ip_data is None:
            return []
        return ip_data
