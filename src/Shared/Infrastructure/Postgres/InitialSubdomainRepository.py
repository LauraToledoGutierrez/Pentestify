from Shared.Infrastructure.Postgres import PostgresConnection
from Shared.Domain.InitialSubdomain import InitialSubdomain
from typing import List
from Shared.Domain.InitialSubdomainInterface import InitialSubdomainInterface


class InitialSubdomainRepository(InitialSubdomainInterface):
    database_connector: PostgresConnection

    def __init__(self, database_connector: PostgresConnection):
        self.database_connector = database_connector

    def get_subdomains(self) -> List[InitialSubdomain]:
        subdomains = self.database_connector.query_all(
            "SELECT name FROM initial_subdomains;")
        if subdomains is None:
            return []
        return [InitialSubdomain(row[0]) for row in subdomains]
