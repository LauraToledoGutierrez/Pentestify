import psycopg2


class PostgresConnection:
    connection = None
    cursor = None

    def __init__(self):
        self.connection = None

    def connect(self):
        try:

            self.connection = psycopg2.connect(user="postgres",
                                               password="postgres",
                                               host="localhost",
                                               port="5432",
                                               database="postgres")

            self.cursor = self.connection.cursor()
            print("Connected to the database")
        except (Exception, psycopg2.Error) as e:
            raise Exception(
                f"An error occurred while connecting to the database: {e}")

    def query_all(self, query):
        try:
            self.cursor.execute(query)
            return self.cursor.fetchall()
        except (Exception, psycopg2.Error) as e:
            raise Exception(
                f"An error occurred while executing the query: {e}")

    def execute_query(self, query, params=None):
        try:
            self.cursor.execute(query, params)
            self.connection.commit()
        except (Exception, psycopg2.Error) as e:
            raise Exception(
                f"An error occurred while executing the query: {e}")
