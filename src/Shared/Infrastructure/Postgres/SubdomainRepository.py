from typing import List
from Shared.Domain.Subdomain import Subdomain
from Shared.Domain.SubdomainRepositoryInterface import SubdomainRepositoryInterface
from Shared.Infrastructure.Postgres.PostgresConnection import PostgresConnection


class SubdomainRepository(SubdomainRepositoryInterface):

    database_conector: PostgresConnection

    def __init__(self, database_conector: PostgresConnection):
        self.database_conector = database_conector

    def get_subdomains(self, domain: str) -> List[Subdomain]:
        subdomains = self.database_conector.query_all(
            "SELECT name, ip_address FROM subdomains;")
        subdomains = [Subdomain(row[0], row[1]) for row in subdomains]
        return subdomains
