import pytest
import unittest
from unittest.mock import MagicMock
from NetworkManagement.Application.AnalyseIP import AnalyseIP
from NetworkManagement.Domain.AnalyseIPInterface import AnalyseIPInterface


class AnalyseIP_test(unittest.TestCase):
    def setUp(self):
        self.mock_analyseipexe = MagicMock(AnalyseIPInterface)

    def test_execute_successful(self):
        analyse_ip = AnalyseIP(self.mock_analyseipexe)

        analyse_ip.execute()

        self.mock_analyseipexe.analyze.assert_called_once()

    def test_execute_exception_handling(self):
        self.mock_analyseipexe.analyze.side_effect = Exception(
            "Test exception")
        analyse_ip = AnalyseIP(self.mock_analyseipexe)

        with pytest.raises(Exception) as exc_info:
            analyse_ip.execute()

        assert str(exc_info.value) == "Test exception"
        self.mock_analyseipexe.analyze.assert_called_once()
